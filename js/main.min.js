function sliderMain() {
    var swiper = new Swiper('.main .swiper', {
        slidesPerView: '1',
        spaceBetween: 32,
        effect: "fade",
        loop: true,
        speed: 1000,
        autoplay: {
            delay: 3000,
            disableOnInteraction: false
        },
        navigation: {
            nextEl: ".main .swiper-button-next",
            prevEl: ".main .swiper-button-prev",
        },
    })
}

function sliderTags() {
    var swiper = new Swiper('.tags__slider .swiper', {
        slidesPerView: "auto",
        spaceBetween: 16,
    })
}

function sliderPortfolio() {
    var swiper = new Swiper('.portfolio__slider .swiper', {
        slidesPerView: 3,
        spaceBetween: 32,
        breakpoints: {
            320: {
                slidesPerView: 1,
                spaceBetween: 24,
            },
            577: {
                slidesPerView: 2,
                spaceBetween: 24,
            },
            993: {
                slidesPerView: 3,
                spaceBetween: 32,
            }
        }
    })
}

function sliderPortfolioImages() {
    var swiper = new Swiper('.portfolio-main__images .swiper', {
        slidesPerView: 1.168,
        spaceBetween: 32,
        breakpoints: {
            320: {
                spaceBetween: 12,
            },
            768: {
                spaceBetween: 32,
            }
        }
    })
}

function sliderNews() {
    var swiper = new Swiper('.news__slider .swiper', {
        slidesPerView: 3,
        spaceBetween: 32,
        breakpoints: {
            320: {
                slidesPerView: 1,
                spaceBetween: 24,
            },
            577: {
                slidesPerView: 2,
                spaceBetween: 24,
            },
            993: {
                slidesPerView: 3,
                spaceBetween: 32,
            }
        }
    })
}

$(document).ready(function() {
    sliderMain();
    sliderTags();
    sliderPortfolio();
    sliderPortfolioImages();
    sliderNews();


    // Menu
    $('.burger').click(function () {
        $(this).toggleClass('burger--active')
        $('.header__wrap').toggleClass('header__wrap--active')
        $('body').toggleClass('fixed-body')
    })

    $(".header-item").hover(onIn, onOut),
        $(".header-item .header-item__show").click((function() {
                $(this).parents(".header-item").hasClass("header-item--active") ?
                $(this).parents(".header-item").removeClass("header-item--active") :
                $(this).parents(".header-item").addClass("header-item--active")
            }
        )),

    // Tabs
    $(".tab").hover(function () {
        let path = $(this).attr("data-tab-path");
        $(this).siblings(".tab").removeClass("tab--active");
        $(this).addClass("tab--active");

        $(this).parents(".tabs").find(".tab__content").removeClass("tab__content--active");
        $(this).parents(".tabs").find(`.tab__content[data-content-path="${path}"]`).addClass("tab__content--active");
    });

    $(".tab2").click(function () {
        let path = $(this).attr("data-tab-path2");
        $(this).siblings(".tab2").removeClass("tab2--active");
        $(this).addClass("tab2--active");

        $(this).parents(".tabs2").find(".tab__content2").removeClass("tab__content2--active");
        $(this).parents(".tabs2").find(`.tab__content2[data-content-path2="${path}"]`).addClass("tab__content2--active");
    });

    $(".hover__tab").mouseover((function() {
        let e = $(this).attr("data-tab-path");
        $(this).parents(".hover__slide").find(".hover__tab").removeClass("hover__tab--active"),
        $(this).addClass("hover__tab--active"),
        $(this).parents(".hover__slide").find(".hover__content").removeClass("hover__content--active"),
        $(this).parents(".hover__slide").find(`.hover__content[data-tab-path="${e}"]`).addClass("hover__content--active")
    })),

    // Accordion
    $(".item-show").click(function () {
        let parent = $(this).parents(".item")
        if($(parent).hasClass("item--active")){
            $(".item").removeClass("item--active")
            $(".item-hidden").slideUp()
        }else{
            $(".item").removeClass("item--active")
            $(parent).addClass("item--active")
            $(".item-hidden").slideUp()
            $(this).siblings(".item-hidden").slideDown()
        }
    })

    // Form
    $(".russia[type='tel']").inputmask({
        mask: [
            '(999) 999-99-99', // Россия
        ],
        keepStatic: true,
    });
    $(".ukraine[type='tel']").inputmask({
        mask: [
            '(99) 999-99-99', // Украина
        ],
        keepStatic: true,
    });
    $(".belarus[type='tel']").inputmask({
        mask: [
            '(99) 999-99-99', // Беларусь
        ],
        keepStatic: true,
    });
    $(".united-states[type='tel']").inputmask({
        mask: [
            '(999) 999-9999',   // США
        ],
        keepStatic: true,
    });
    $(".united-kingdom[type='tel']").inputmask({
        mask: [
            '(999) 999-9999',  // Великобритания
        ],
        keepStatic: true,
    });
    $(".france[type='tel']").inputmask({
        mask: [
            '(0) 99 99 99 99', // Франция
        ],
        keepStatic: true,
    });

    $('.form-btn').on('click', function() {
        var form = $(this).closest('.form');
        var isValid = true;

        form.find('.form-group').removeClass('active active2');

        form.find('.input-name').each(function() {
            var namePattern = /^[A-Za-zА-Яа-яЁё\s]+$/;
            if ($(this).val().trim() === '' || !namePattern.test($(this).val())) {
                $(this).closest('.form-group').addClass('active');
                isValid = false;
            } else {
                $(this).closest('.form-group').addClass('active2');
            }
        });

        form.find('input[type="email"]').each(function() {
            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if ($(this).val().trim() !== '' && !emailPattern.test($(this).val())) {
                $(this).closest('.form-group').addClass('active');
                isValid = false;
            } else if ($(this).val().trim() !== '') {
                $(this).closest('.form-group').addClass('active2');
            }
        });

        form.find('.tab__content2--active input[type="tel"]').each(function() {
            var telPattern;
            if ($(this).hasClass('russia')) {
                telPattern = /^\(\d{3}\) \d{3}-\d{2}-\d{2}$/;
            } else if ($(this).hasClass('ukraine') || $(this).hasClass('belarus')) {
                telPattern = /^\(\d{2}\) \d{3}-\d{2}-\d{2}$/;
            } else if ($(this).hasClass('united-states') || $(this).hasClass('united-kingdom')) {
                telPattern = /^\(\d{3}\) \d{3}-\d{4}$/;
            } else if ($(this).hasClass('france')) {
                telPattern = /^\(0\) \d{2} \d{2} \d{2} \d{2}$/;
            }

            if ($(this).val().trim() === '' || !telPattern.test($(this).val())) {
                $(this).closest('.tab__content2--active').addClass('active');
                isValid = false;
            } else {
                $(this).closest('.tab__content2--active').removeClass('active');
                $(this).closest('.tab__content2--active').addClass('active2');
            }
        });

        if (isValid) {
            form[0].submit();
        }
    });

    $('.tab__content2 input[type="tel"]').on('input', function() {
        var telPattern;
        if ($(this).hasClass('russia')) {
            telPattern = /^\(\d{3}\) \d{3}-\d{2}-\d{2}$/;
        } else if ($(this).hasClass('ukraine') || $(this).hasClass('belarus')) {
            telPattern = /^\(\d{2}\) \d{3}-\d{2}-\d{2}$/;
        } else if ($(this).hasClass('united-states') || $(this).hasClass('united-kingdom')) {
            telPattern = /^\(\d{3}\) \d{3}-\d{4}$/;
        } else if ($(this).hasClass('france')) {
            telPattern = /^\(0\) \d{2} \d{2} \d{2} \d{2}$/;
        }

        if ($(this).val().trim() === '' || !telPattern.test($(this).val())) {
            $(this).closest('.tab__content2--active').addClass('active');
        } else {
            $(this).closest('.tab__content2--active').removeClass('active');
            $(this).closest('.tab__content2--active').addClass('active2');
        }
    });




    // Валидация для имени
    $('.input-name').on('input', function() {
        this.value = this.value.replace(/[^A-Za-zА-Яа-яЁё\s]/g, '');
    });

    // $('.form-btn').on('click', function() {
    //     var form = $(this).closest('.form');
    //     var isValid = true;
    //
    //     form.find('.form-group').removeClass('active active2');
    //
    //     form.find('.input-name').each(function() {
    //         var namePattern = /^[A-Za-zА-Яа-яЁё\s]+$/;
    //         if ($(this).val().trim() === '' || !namePattern.test($(this).val())) {
    //             $(this).closest('.form-group').addClass('active');
    //             isValid = false;
    //         } else {
    //             $(this).closest('.form-group').addClass('active2');
    //         }
    //     });
    //
    //     form.find('input[type="email"]').each(function() {
    //         var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    //         if ($(this).val().trim() !== '' && !emailPattern.test($(this).val())) {
    //             $(this).closest('.form-group').addClass('active');
    //             isValid = false;
    //         } else if ($(this).val().trim() !== '') {
    //             $(this).closest('.form-group').addClass('active2');
    //         }
    //     });
    //
    //     if (isValid) {
    //         form[0].submit();
    //     }
    // });
    //
    // $('.input-name').on('input', function() {
    //     this.value = this.value.replace(/[^A-Za-zА-Яа-яЁё\s]/g, '');
    // });

    // $('.input-phone').intlInputPhone({ preferred_country: ['ru'] });
    // $('.input-phone input').attr('placeholder', '924 456 65-64');
    //
    // $('.phoneNumber').on('input', function() {
    //     this.value = this.value.replace(/[^0-9]/g, '');
    //     if (this.value.length > 10) {
    //         this.value = this.value.slice(0, 10);
    //     }
    //
    //     if (this.value.length >= 6) {
    //         this.value = this.value.replace(/(\d{3})(\d{3})(\d{2})(\d{2})/, '$1 $2 $3-$4');
    //     } else if (this.value.length >= 3) {
    //         this.value = this.value.replace(/(\d{3})(\d{3})/, '$1 $2');
    //     }
    // });

    $('.select-head').click(function () {
        $(this).parent('.select-wrap').toggleClass('select-wrap--active')
    })

    $('.select-body li').click(function () {
        var currentele = $(this).html()
        $(this).parents('.select-wrap').find('.select-current').html(currentele)
        $(this).parents('.select-wrap').removeClass('select-wrap--active')
        $(this).siblings(".select-body li").removeClass("li--active")
        $(this).addClass("li--active")
    })

    let selectLi = $('.select-body li')
    let selectWrap = $('.select-wrap')

    $(document).click(function (e) {
        if ( !selectLi.is(e.target) && selectLi.has(e.target).length === 0 &&
            !selectWrap.is(e.target) && selectWrap.has(e.target).length === 0

        ) {
            selectWrap.removeClass('select-wrap--active')
        }
    })


    // Cookie
    $('.cookie__btn').click(function () {
        $(this).parent('.cookie').remove()        
    })

    // Tags
    $('.tags__btn').click(function () {
        $('.tags__slider').addClass('tags__slider--active')
        $('body').addClass('fixed-body')
    })

    $('.tags__close').click(function () {
        $('.tags__slider').removeClass('tags__slider--active')
        $('body').removeClass('fixed-body')
    })

    $('.tag').click(function () {
        $(this).parents('.tags__slider').removeClass('tags__slider--active')
        $('body').removeClass('fixed-body')
    })

    $(document).ready(function() {
        var $targetBlock = $('.tags__slider');
        var blockOffset = $targetBlock.offset().top;
        var blockHeight = $targetBlock.outerHeight();

        $(window).on('scroll', function() {
            if ($(window).width() >= 993) {
                var scrollTop = $(window).scrollTop();

                if (scrollTop > blockOffset + blockHeight) {
                    $targetBlock.addClass('tags__slider--active');
                } else {
                    $targetBlock.removeClass('tags__slider--active');
                }
            } else {
                $targetBlock.removeClass('tags__slider--active');
            }
        });
    });


    // Show All
    $('.show-more__btn').click(function () {
        $(this).toggleClass('show-more__btn--active')
        $(this).siblings('.text-overflow').toggleClass('text-overflow--active')
    })

    $('.show-more').click(function () {
        $(this).toggleClass('show-more--active')
        $(this).siblings('.all-cards').toggleClass('all-cards--active')
    })

    // Modal
    $("[data-modal]").click(function () {
        let modalId = $(this).attr("data-modal")

        openModal(modalId)
    })

    function openModal(modalId){
        $(`#${modalId}`).addClass("modal--active")
        $("body").addClass("fixed-body")
    }

    $(".modal").click(function () {
        closeModal()
    })

    $("._close-modal").click(function () {
        closeModal()
    })

    $(".modal__dialog").click(function (e) {
        e.stopPropagation()
    })


    function closeModal() {
        $('.modal').removeClass("modal--active")
        $("body").removeClass("fixed-body")
    }

})

function onIn() {
    if (window.innerWidth > 992) {
        let e = $(this);
        setTimeout((function() {
                e.is(":hover") && (console.log(e),
                    e.addClass("header-item--active"))
            }
        ), 200)
    }
}
function onOut() {
    window.innerWidth > 992 && $(this).removeClass("header-item--active")
}




